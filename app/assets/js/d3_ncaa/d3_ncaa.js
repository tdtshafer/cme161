var Cfb = function() {
  this.data = {
        "name": "NCAA D-1",
        "children": [{
            "name": "FBS",
            "children": [{
                "name": "Power Five Conferences",
                "children": [{
                  "name": "Atlantic Coast Conference",
                  "children": [{
                      "name": "Boston College Eagles"
                    }, {
                      "name": "Clemson Tigers"
                    }, {
                      "name": "Duke Blue Devils"
                    }, {
                      "name": "Florida State Seminoles"
                    }, {
                      "name": "Georgia Tech Yellow Jackets"
                    }, {
                      "name": "Louisville Cardinals"
                    }, {
                      "name": "Miami Hurricanes"
                    }, {
                      "name": "North Carolina State Wolfpack"
                    }, {
                      "name": "North Carolina Tarheels"
                    }, {
                      "name": "Pittsburgh Panthers"
                    }, {
                      "name": "Syracuse Orange"
                    }, {
                      "name": "Virginia Cavaliers"
                    }, {
                      "name": "Virgina Tech Hokies"
                    }, {
                      "name": "Wake Forest Demon Deacons"
                    }] //end ACC
                }, {
                  "name": "Big 12",
                  "children": [{
                      "name": "Baylor Bears"
                    }, {
                      "name": "Iowa State Cyclones"
                    }, {
                      "name": "Kansas Jayhawks"
                    }, {
                      "name": "Kansas State Wildcats"
                    }, {
                      "name": "Oklahoma Sooners"
                    }, {
                      "name": "Oklahoma State Cowboys"
                    }, {
                      "name": "Texas Christian University Horned Frogs"
                    }, {
                      "name": "Texas Longhorns"
                    }, {
                      "name": "Texas Tech Red Raiders"
                    }, {
                      "name": "West Virginia Mountaineers"
                    }] //end Big12
                }, {
                  "name": "Big Ten",
                  "children": [{
                      "name": "Illinois Fighting Illini"
                    }, {
                      "name": "Indiana Hoosiers"
                    }, {
                      "name": "Iowa Hawkeyes"
                    }, {
                      "name": "Maryland Terrapins"
                    }, {
                      "name": "Michigan Wolverines"
                    }, {
                      "name": "Michigan State Spartans"
                    }, {
                      "name": "Minnesota Golden Gophers"
                    }, {
                      "name": "Nebraska Cornhuskers"
                    }, {
                      "name": "Northwestern Wildcats"
                    }, {
                      "name": "Ohio State Buckeyes"
                    }, {
                      "name": "Penn State Nittany Lions"
                    }, {
                      "name": "Purdue Boilermakers"
                    }, {
                      "name": "Rutgers Scarlet Knights"
                    }, {
                      "name": "Wisconsin Badgers"
                    }] //end Big 10
                }, {
                  "name": "Southeastern Conference",
                  "children": [{
                      "name": "Alabama Crimson Tide"
                    }, {
                      "name": "Arkansas Razorbacks"
                    }, {
                      "name": "Auburn Tigers"
                    }, {
                      "name": "Florida Gators"
                    }, {
                      "name": "Georgia Bulldogs"
                    }, {
                      "name": "Kentucky Wildcats"
                    }, {
                      "name": "LSU Tigers"
                    }, {
                      "name": "Mississippi State Bulldogs"
                    }, {
                      "name": "Missouri Tigers"
                    }, {
                      "name": "Ole Miss Rebels"
                    }, {
                      "name": "South Carolina Gamecocks"
                    }, {
                      "name": "Tennessee Volunteers"
                    }, {
                      "name": "Texas A&M Aggies"
                    }, {
                      "name": "Vanderbilt Commodores"
                    }] //end SEC
                }, {
                  "name": "Pac-12 Conference",
                  "children": [{
                      "name": "Arizona Wildcats"
                    }, {
                      "name": "Arizona State Sun Devils"
                    }, {
                      "name": "California Golden Bears"
                    }, {
                      "name": "Colorado Buffalo"
                    }, {
                      "name": "Oregon Ducks"
                    }, {
                      "name": "Oregon State Beavers"
                    }, {
                      "name": "Stanford Cardinal"
                    }, {
                      "name": "UCLA Bruins"
                    }, {
                      "name": "USC Trojans"
                    }, {
                      "name": "Washington Huskies"
                    }, {
                      "name": "Washington State Cougars"
                    }] //end Pac12

                }]
              }, { //end P5

                "name": "Group of Five Conferences",
                "children": [{
                  "name": "American Athletic Conference",
                  "children": [{
                    "name": "Cincinnati Bearcats"
                  }, {
                    "name": "Connecticut Huskies"
                  }, {
                    "name": "East Carolina Pirates"
                  }, {
                    "name": "Houston Cougars"
                  }, {
                    "name": "Memphis Tigers"
                  }, {
                    "name": "Navy Midshipmen"
                  }, {
                    "name": "SMU Mustangs"
                  }, {
                    "name": "South Flordia Bulls"
                  }, {
                    "name": "Temple Owls"
                  }, {
                    "name": "Tulane Green Wave"
                  }, {
                    "name": "Tulsa Golden Hurricane"
                  }, {
                    "name": "UCF Knights"
                  }]
                }, {
                  //end AAC
                  "name": "Conference USA",
                  "children": [{
                      "name": "Charlotte 49ers"
                    }, {
                      "name": "Florida Atlantic Owls"
                    }, {
                      "name": "Florida Int'l Golden Panthers"
                    }, {
                      "name": "Louisiana Tech Bulldogs"
                    }, {
                      "name": "Marshall Thundering Herd"
                    }, {
                      "name": "Middle Tennessee Blue Raiders"
                    }, {
                      "name": "North Texas Mean Green"
                    }, {
                      "name": "Old Dominion Monarchs"
                    }, {
                      "name": "Rice Owls"
                    }, {
                      "name": "Southern Mississippi Golden Eagles"
                    }, {
                      "name": "Texas San Antonio Roadrunners"
                    }, {
                      "name": "UAB Blazers"
                    }, {
                      "name": "UTEP Miners"
                    }, {
                      "name": "Western Kentucky Hilltoppers"
                    }] //end C-USA
                }, {
                  "name": "Mid-American Conference",
                  "children": [{
                      "name": "Akron Zips"
                    }, {
                      "name": "Ball State Cardinals"
                    }, {
                      "name": "Bowling Green Falcons"
                    }, {
                      "name": "Buffalo Bulls"
                    }, {
                      "name": "Central Michigan Chippewas"
                    }, {
                      "name": "Eastern Michigan Eagles"
                    }, {
                      "name": "Kent State Golden Flashes"
                    }, {
                      "name": "Massachusetts Minutemen"
                    }, {
                      "name": "Miami (OH) RedHawks"
                    }, {
                      "name": "Northern Illinois Huskies"
                    }, {
                      "name": "Ohio Bobcats"
                    }, {
                      "name": "Toledo Rockets"
                    }, {
                      "name": "UTEP Miners"
                    }, {
                      "name": "Western Michigan Broncos"
                    }] //end MAC
                }, {
                  "name": "Mountain West Conference",
                  "children": [{
                      "name": "Air Force Falcons"
                    }, {
                      "name": "Boise State Broncos"
                    }, {
                      "name": "Colorado State Rams"
                    }, {
                      "name": "Fresno State Bulldogs"
                    }, {
                      "name": "Hawaii Rainbow Warriors"
                    }, {
                      "name": "Nevada Wolf Pack"
                    }, {
                      "name": "New Mexico Lobos"
                    }, {
                      "name": "San Diego State Aztecs"
                    }, {
                      "name": "San Jose State Spartans"
                    }, {
                      "name": "UNLV Rebels"
                    }, {
                      "name": "Utah State Aggies"
                    }, {
                      "name": "Wyoming Cowboys"
                    }] //end MWC
                }, {
                  "name": "Sun Belt Conference",
                  "children": [{
                      "name": "Appalachian State Mountaineers"
                    }, {
                      "name": "Arkansas State Red Wolves"
                    }, {
                      "name": "Georgia Southern Eagles"
                    }, {
                      "name": "Georgia State Panthers"
                    }, {
                      "name": "Idaho Vandals"
                    }, {
                      "name": "Louisiana Lafayette Ragin' Cajuns"
                    }, {
                      "name": "Louisiana Monroe Warhawks"
                    }, {
                      "name": "New Mexico State Aggies"
                    }, {
                      "name": "South Alabama Jaguars"
                    }, {
                      "name": "Texas State Bobcats"
                    }, {
                      "name": "Troy Trojans"
                    }] //end Sun Belt
                }]
              }, { //end G5
                "name": "Independent Schools",
                "children": [{
                    "name": "Army Black Knights"
                  }, {
                    "name": "BYU Cougars"
                  }, {
                    "name": "Notre Dame Fighting Irish"
                  }] //end Independent
              }] // end FBS
          }]// End Division-i
      }; //end total wrapper
};

searchFunc = function(input)
{ 
  document.getElementById("hierarchy").innerHTML = "";
  var search_term = input;



var cfb_min = (new Cfb()).data;
cfb_min.children = cfb_min.children.splice(-3);
cfb_min.children = cfb_min.children.slice(-2);

var height = 600,
  width = 700;

var svg = d3
  .select("#hierarchy")
  .append("svg")
  .attr("height", height)
  .attr("width", width)
  .append("g")
  .attr("transform", "translate(100,0)");

var tree = d3
  .layout
  .tree()
  .size([height, width - 250]);

var diagonal = d3
  .svg
  .diagonal()
  .projection(function(d) {
    return [d.y, d.x];
  });
  

function findInPath(source, text) {
  if (source.name.search(text) > 0) {
    return true;
  } else if (source.children || source._children) {
    var c = source.children ? source.children : source._children;
    for (var i = 0; i < c.length; i++) {
      if (findInPath(c[i], text)) {
        return true;
      }
    }
  }
  return false;
}

var linkFilter = function(d) {
  return findInPath(d.target, search_term)
}


cfb_min.x0 = height / 2;
cfb_min.y0 = 0;

var i = 0;
var duration = 100;

update(cfb_min);

function update(source) {

  var nodes = tree.nodes(cfb_min);
  var links = tree.links(nodes);

  var node = svg.selectAll("g.node")
    .data(nodes, function(d) {
      return d.id || (d.id = ++i);
    });

  var nodeEnter = node
    .enter()
    .append("g")
    .attr("class", "node")
    .on("click", click);

  nodeEnter.append("circle")
    .attr("r", 1e-6)
    .style("stroke", "black")
    .style("stroke-width", "1.5px");

  nodeEnter.append("text")
    .attr("x", function(d) {
      return d.children || d._children ? -15 : 10;
    })
    .attr("dy", ".35em")
    .attr("text-anchor", function(d) {
      return d.children || d._children ? "end" : "start";
    })
    .text(function(d) {
      return d.name;
    })
    .style("fill-opacity", 1e-6)
    .style("font", "10px sans-serif")
    .style("fill", "black")
    .style("stroke-width", ".01px");

  var nodeUpdate = node.transition()
  	.duration(duration)
    .attr("transform", function(d) {
      return "translate(" + d.y + "," + d.x + ")";
    })


  nodeUpdate.select("circle")
    .filter(function(d) {
      return findInPath(d, search_term)
    })
    .style("fill", function(d) {
      return d._children ? "darkgreen" : "#fff";
    });

  nodeUpdate.select("circle")
    .filter(function(d) {
      return !findInPath(d, search_term)
    })
    .style("display", "none");
    
  nodeUpdate.select("circle")
    .attr("r", 3)
    .style("stroke", "green")
    .style("stroke-width", "1.5px");

  nodeUpdate.select("text")
  	.filter(function(d) {
    	return !findInPath(d, search_term)
    })
    .style("display", "none");
   
   nodeUpdate.select("text")
    .style("fill-opacity", 1)
    .style("font", "10px sans-serif")
    .style("fill", "black")
    .style("stroke-width", ".01px");


 var nodeExit = node.exit()
    .remove();


  nodeExit.select("circle")
    .attr("r", 1e-6);

  nodeExit.select("text")
    .style("fill-opacity", 1e-6);


  var link = svg.selectAll("path.link")
    .data(links, function(d) {
      return d.target.id;
    });

  link.enter().
  	insert("path", "g")
    .attr("class", "link")
    .style("fill", "none")
    .style("stroke-width", "1.5px");

  link.transition()
    .duration(duration)
    .attr("d", diagonal);

  link.exit()
    .remove();

  link.filter(linkFilter).style("stroke", "lightgreen");
  link.filter(function(d) {
    return !linkFilter(d);
  }).style("display", "none");

  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });
}

function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
  }
}
